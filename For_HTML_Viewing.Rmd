---
title: "All Campaigns Quarterly"
author: "Office of Marketing and Brand Management"
date: "7/22/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```


```{r include=FALSE}
library(dplyr)
library(knitr)
library(kableExtra)
library(tinytex)
library(hms)
library(lubridate)
library(stringr)
library(tidyr)
```



```{r}
NewData1 <- read.csv("C:/Users/christine.iyer/Box/quarterly-ad-analytics-projects/Flowchart - Copy.csv", header = T, stringsAsFactors = F)
NewData1 <- NewData1 %>% 
  mutate(CTR = as.numeric(CTR),
         BR = as.numeric(BR))
```



```{r}
NewData2 <- NewData1 %>% 
  mutate(AdSets = str_sub(AdSet,6),BR = as.numeric(BR)) %>% 
  group_by(Quarter,AdSets ) %>% 
  summarise(Impressions = sum(Impressions), 
            CTR = mean(CTR), 
            UPV = sum(UPV), 
            BR = mean(BR)) %>% 
filter(Quarter != "") %>% select(AdSets, Quarter, everything())


spec_1 <- build_wider_spec(NewData2,
            names_from = Quarter, 
            values_from = c(Impressions:BR))

nD_3 <- NewData2 %>% pivot_wider_spec(spec_1, values_fill = 0)


nD4 <- nD_3 %>% 
  mutate(Campaign = ifelse(grepl("DC",AdSets),"DC",
                           ifelse(grepl("HS", AdSets), "HS", 
                                  ifelse(grepl("TR", AdSets), "TR", 
                                         ifelse(grepl("GR", AdSets), "GR", 
                                                ifelse(grepl("TL", AdSets), "TL", 
                                                       ifelse(grepl("CGCY", AdSets), "CGCY", 
                                                              ifelse(grepl("MPH|POL", AdSets), "MUS",
                                                                     ifelse(grepl("IN", AdSets),"IN",
                                                                                  ifelse(grepl("CLR",AdSets), "CLR", 
                                                                                               ifelse(grepl("ER|VT",AdSets) , "Tours", 
                                                                                                      ifelse(grepl("IC", AdSets), "SIC",  "Other"))))))))))), 
         Medium = ifelse(grepl("DISP", AdSets), "DISP", 
         ifelse(grepl("VID", AdSets), "VID", 
                ifelse(grepl("ST", AdSets), "ST",
                       ifelse(grepl("TEXT", AdSets), "TEXT",
                              ifelse(grepl("CAR", AdSets), "CAR", "AUD" )))))) %>% select(Medium,Campaign, everything()) %>% arrange(Medium)
```

# Product and/or Audience {.tabset .tabset-pills}

## High School Students {.tabset .tabset-pills}

### Impressions

```{r}
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets:Impressions_FY20Q4) %>% 
        mutate(
          Impressions_FY19Q1 = prettyNum(Impressions_FY19Q1, big.mark = ","),
          Impressions_FY19Q2 = prettyNum(Impressions_FY19Q2, big.mark = ","),
          Impressions_FY19Q3 = prettyNum(Impressions_FY19Q3, big.mark = ","),
          Impressions_FY19Q4 = prettyNum(Impressions_FY19Q4, big.mark = ","),
          Impressions_FY20Q1 = prettyNum(Impressions_FY20Q1, big.mark = ","),
          Impressions_FY20Q2 = prettyNum(Impressions_FY20Q2, big.mark = ","),
          Impressions_FY20Q3 = prettyNum(Impressions_FY20Q3, big.mark = ","),
          Impressions_FY20Q4 = prettyNum(Impressions_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q1 = Impressions_FY19Q1, FY19Q2 = Impressions_FY19Q2, FY19Q3 = Impressions_FY19Q3, FY19Q4 = Impressions_FY19Q4, FY20Q1 = Impressions_FY20Q1, FY20Q2 = Impressions_FY20Q2, FY20Q3 = Impressions_FY20Q3, FY20Q4 = Impressions_FY20Q4)) %>% 
  kable_styling("striped")  %>%

  pack_rows("Display", 1, 5) %>%
  pack_rows("Story", 6, 6) %>%
  pack_rows("Video", 7, 11) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Impressions" = 8))
```



### Click Through Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets, CTR_FY19Q1:CTR_FY20Q4) %>% 
        mutate(
          CTR_FY19Q1 = paste0(round(CTR_FY19Q1*100,2), "%"),
          CTR_FY19Q2 = paste0(round(CTR_FY19Q2*100,2), "%"),
          CTR_FY19Q3 = paste0(round(CTR_FY19Q3*100,2), "%"),
          CTR_FY19Q4 = paste0(round(CTR_FY19Q4*100,2), "%"),
          CTR_FY20Q1 = paste0(round(CTR_FY20Q1*100,2), "%"),
          CTR_FY20Q2 = paste0(round(CTR_FY20Q2*100,2), "%"),
          CTR_FY20Q3 = paste0(round(CTR_FY20Q3*100,2), "%"),
          CTR_FY20Q4 = paste0(round(CTR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = CTR_FY19Q1, FY19Q2 = CTR_FY19Q2, FY19Q3 = CTR_FY19Q3, FY19Q4 = CTR_FY19Q4, FY20Q1 = CTR_FY20Q1, FY20Q2 = CTR_FY20Q2, FY20Q3 = CTR_FY20Q3, FY20Q4 = CTR_FY20Q4)) %>% 
  kable_styling("striped") %>%

  pack_rows("Display", 1, 5) %>%
  pack_rows("Story", 6, 6) %>%
  pack_rows("Video", 7, 11) %>%   
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Click Through Rate" = 8))
```

### Unique Pageviews

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets, UPV_FY19Q1:UPV_FY20Q4) %>% 
        mutate(
          UPV_FY19Q1 = prettyNum(UPV_FY19Q1, big.mark = ","),
          UPV_FY19Q2 = prettyNum(UPV_FY19Q2, big.mark = ","),
          UPV_FY19Q3 = prettyNum(UPV_FY19Q3, big.mark = ","),
          UPV_FY19Q4 = prettyNum(UPV_FY19Q4, big.mark = ","),
          UPV_FY20Q1 = prettyNum(UPV_FY20Q1, big.mark = ","),
          UPV_FY20Q2 = prettyNum(UPV_FY20Q2, big.mark = ","),
          UPV_FY20Q3 = prettyNum(UPV_FY20Q3, big.mark = ","),
          UPV_FY20Q4 = prettyNum(UPV_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q1 = UPV_FY19Q1, FY19Q2 = UPV_FY19Q2, FY19Q3 = UPV_FY19Q3, FY19Q4 = UPV_FY19Q4, FY20Q1 = UPV_FY20Q1, FY20Q2 = UPV_FY20Q2, FY20Q3 = UPV_FY20Q3, FY20Q4 = UPV_FY20Q4)) %>% 
  kable_styling("striped")  %>%

  pack_rows("Display", 1, 5) %>%
  pack_rows("Story", 6, 6) %>%
  pack_rows("Video", 7, 11) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Unique Page Views" = 8))
```




### Bounce Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets, BR_FY19Q1:BR_FY20Q4) %>% 
        mutate(
          BR_FY19Q1 = paste0(round(BR_FY19Q1*100,2), "%"),
          BR_FY19Q2 = paste0(round(BR_FY19Q2*100,2), "%"),
          BR_FY19Q3 = paste0(round(BR_FY19Q3*100,2), "%"),
          BR_FY19Q4 = paste0(round(BR_FY19Q4*100,2), "%"),
          BR_FY20Q1 = paste0(round(BR_FY20Q1*100,2), "%"),
          BR_FY20Q2 = paste0(round(BR_FY20Q2*100,2), "%"),
          BR_FY20Q3 = paste0(round(BR_FY20Q3*100,2), "%"),
          BR_FY20Q4 = paste0(round(BR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = BR_FY19Q1, FY19Q2 = BR_FY19Q2, FY19Q3 = BR_FY19Q3, FY19Q4 = BR_FY19Q4, FY20Q1 = BR_FY20Q1, FY20Q2 = BR_FY20Q2, FY20Q3 = BR_FY20Q3, FY20Q4 = BR_FY20Q4)) %>% 
  kable_styling("striped")  %>%

  pack_rows("Display", 1, 5) %>%
  pack_rows("Story", 6, 6) %>%
  pack_rows("Video", 7, 11) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Bounce Rate" = 8))
```


### Inquiries


```{r}
Forms <- read.csv("C:/Users/christine.iyer/Box/quarterly-ad-analytics-projects/ThankYouFormCompletions.csv", header = T, stringsAsFactors = F)
DCForms <- Forms %>% filter(str_detect(Initial.Referral.Source,"HS")) %>% 
  group_by(Created.Date) %>% 
  summarise(Inq = n()) %>% arrange(desc(Inq))


DCForms <- DCForms %>% 
  mutate(Date = as.Date(Created.Date, format = "%m/%d/%Y"),
         Quarter = ifelse(Date < "2018-10-01", "FY19 Q1", 
                          ifelse(Date >= "2018-10-01" & Date < "2018-12-31", "FY19 Q2", 
                                 ifelse(Date >= "2019-01-01" & Date < "2019-04-01", "FY19 Q3",
                                        ifelse(Date >= "2019-04-01" & Date < "2019-06-30", "FY19 Q4",
                                               ifelse(Date >= "2019-01-01" & Date < "2019-10-01", "FY20 Q1",
                                                      ifelse(Date >= "2019-10-01" & Date < "2019-12-31", "FY20 Q2",
                                                             ifelse(Date >= "2020-01-01" & Date < "2020-04-01", "FY20 Q3", "FY20 Q4")))))))) %>%  
        group_by(Quarter) %>% 
        summarise(Inquiries = sum(Inq)) %>% 
  spread(Quarter, Inquiries)
kable(DCForms %>% mutate(Program = "HS") %>% select(Program, everything())) %>% 
  kable_styling()
```


## Current Undergraduates for Transfer {.tabset .tabset-pills}

### Impressions

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TR") %>% 
        select(AdSets:Impressions_FY20Q4) %>% 
        mutate(
          Impressions_FY19Q1 = prettyNum(Impressions_FY19Q1, big.mark = ","),
          Impressions_FY19Q2 = prettyNum(Impressions_FY19Q2, big.mark = ","),
          Impressions_FY19Q3 = prettyNum(Impressions_FY19Q3, big.mark = ","),
          Impressions_FY19Q4 = prettyNum(Impressions_FY19Q4, big.mark = ","),
          Impressions_FY20Q1 = prettyNum(Impressions_FY20Q1, big.mark = ","),
          Impressions_FY20Q2 = prettyNum(Impressions_FY20Q2, big.mark = ","),
          Impressions_FY20Q3 = prettyNum(Impressions_FY20Q3, big.mark = ","),
          Impressions_FY20Q4 = prettyNum(Impressions_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,
               FY19Q1 = Impressions_FY19Q1, 
               FY19Q2 = Impressions_FY19Q2, 
               FY19Q3 = Impressions_FY19Q3, 
               FY19Q4 = Impressions_FY19Q4, 
               FY20Q1 = Impressions_FY20Q1, 
               FY20Q2 = Impressions_FY20Q2, 
               FY20Q3 = Impressions_FY20Q3, 
               FY20Q4 = Impressions_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 4) %>%
  pack_rows("Story", 5, 5) %>%
  pack_rows("Text", 6,6) %>% 
  pack_rows("Video", 7, 10) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Impressions" = 8))
```



### Click Through Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TR") %>% 
        select(AdSets, CTR_FY19Q1:CTR_FY20Q4) %>% 
        mutate(
          CTR_FY19Q1 = paste0(round(CTR_FY19Q1*100,2), "%"),
          CTR_FY19Q2 = paste0(round(CTR_FY19Q2*100,2), "%"),
          CTR_FY19Q3 = paste0(round(CTR_FY19Q3*100,2), "%"),
          CTR_FY19Q4 = paste0(round(CTR_FY19Q4*100,2), "%"),
          CTR_FY20Q1 = paste0(round(CTR_FY20Q1*100,2), "%"),
          CTR_FY20Q2 = paste0(round(CTR_FY20Q2*100,2), "%"),
          CTR_FY20Q3 = paste0(round(CTR_FY20Q3*100,2), "%"),
          CTR_FY20Q4 = paste0(round(CTR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = CTR_FY19Q1, FY19Q2 = CTR_FY19Q2, FY19Q3 = CTR_FY19Q3, FY19Q4 = CTR_FY19Q4, FY20Q1 = CTR_FY20Q1, FY20Q2 = CTR_FY20Q2, FY20Q3 = CTR_FY20Q3, FY20Q4 = CTR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 4) %>%
  pack_rows("Story", 5, 5) %>%
  pack_rows("Text", 6,6) %>% 
  pack_rows("Video", 7, 10) %>%  
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Click Through Rate" = 8))
```

### Unique Pageviews

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TR") %>% 
        select(AdSets, UPV_FY19Q1:UPV_FY20Q4) %>% 
        mutate(
          UPV_FY19Q1 = prettyNum(UPV_FY19Q1, big.mark = ","),
          UPV_FY19Q2 = prettyNum(UPV_FY19Q2, big.mark = ","),
          UPV_FY19Q3 = prettyNum(UPV_FY19Q3, big.mark = ","),
          UPV_FY19Q4 = prettyNum(UPV_FY19Q4, big.mark = ","),
          UPV_FY20Q1 = prettyNum(UPV_FY20Q1, big.mark = ","),
          UPV_FY20Q2 = prettyNum(UPV_FY20Q2, big.mark = ","),
          UPV_FY20Q3 = prettyNum(UPV_FY20Q3, big.mark = ","),
          UPV_FY20Q4 = prettyNum(UPV_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q1 = UPV_FY19Q1, FY19Q2 = UPV_FY19Q2, FY19Q3 = UPV_FY19Q3, FY19Q4 = UPV_FY19Q4, FY20Q1 = UPV_FY20Q1, FY20Q2 = UPV_FY20Q2, FY20Q3 = UPV_FY20Q3, FY20Q4 = UPV_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 4) %>%
  pack_rows("Story", 5, 5) %>%
  pack_rows("Text", 6,6) %>% 
  pack_rows("Video", 7, 10) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Unique Pageviews" = 8))
```




### Bounce Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TR") %>% 
        select(AdSets, BR_FY19Q1:BR_FY20Q4) %>% 
        mutate(
          BR_FY19Q1 = paste0(round(BR_FY19Q1*100,2), "%"),
          BR_FY19Q2 = paste0(round(BR_FY19Q2*100,2), "%"),
          BR_FY19Q3 = paste0(round(BR_FY19Q3*100,2), "%"),
          BR_FY19Q4 = paste0(round(BR_FY19Q4*100,2), "%"),
          BR_FY20Q1 = paste0(round(BR_FY20Q1*100,2), "%"),
          BR_FY20Q2 = paste0(round(BR_FY20Q2*100,2), "%"),
          BR_FY20Q3 = paste0(round(BR_FY20Q3*100,2), "%"),
          BR_FY20Q4 = paste0(round(BR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = BR_FY19Q1, FY19Q2 = BR_FY19Q2, FY19Q3 = BR_FY19Q3, FY19Q4 = BR_FY19Q4, FY20Q1 = BR_FY20Q1, FY20Q2 = BR_FY20Q2, FY20Q3 = BR_FY20Q3, FY20Q4 = BR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 4) %>%
  pack_rows("Story", 5, 5) %>%
  pack_rows("Text", 6,6) %>% 
  pack_rows("Video", 7, 10) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Bounce Rate" = 8))
```


### Inquiries


```{r}
DCForms <- Forms %>% filter(str_detect(Initial.Referral.Source,"TR")) %>% 
  group_by(Created.Date) %>% 
  summarise(Inq = n()) %>% arrange(desc(Inq))


DCForms <- DCForms %>% 
  mutate(Date = as.Date(Created.Date, format = "%m/%d/%Y"),
         Quarter = ifelse(Date < "2018-10-01", "FY19 Q1", 
                          ifelse(Date >= "2018-10-01" & Date < "2018-12-31", "FY19 Q2", 
                                 ifelse(Date >= "2019-01-01" & Date < "2019-04-01", "FY19 Q3",
                                        ifelse(Date >= "2019-04-01" & Date < "2019-06-30", "FY19 Q4",
                                               ifelse(Date >= "2019-01-01" & Date < "2019-10-01", "FY20 Q1",
                                                      ifelse(Date >= "2019-10-01" & Date < "2019-12-31", "FY20 Q2",
                                                             ifelse(Date >= "2020-01-01" & Date < "2020-04-01", "FY20 Q3", "FY20 Q4")))))))) %>%  
        group_by(Quarter) %>% 
        summarise(Inquiries = sum(Inq)) %>% 
  spread(Quarter, Inquiries)
kable(DCForms %>% mutate(Program = "TR") %>% select(Program, everything())) %>% 
  kable_styling()
```
## Graduate Program {.tabset .tabset-pills}

### Impressions

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "GR") %>% 
        select(AdSets:Impressions_FY20Q4) %>% 
        mutate(
          Impressions_FY19Q1 = prettyNum(Impressions_FY19Q1, big.mark = ","),
          Impressions_FY19Q2 = prettyNum(Impressions_FY19Q2, big.mark = ","),
          Impressions_FY19Q3 = prettyNum(Impressions_FY19Q3, big.mark = ","),
          Impressions_FY19Q4 = prettyNum(Impressions_FY19Q4, big.mark = ","),
          Impressions_FY20Q1 = prettyNum(Impressions_FY20Q1, big.mark = ","),
          Impressions_FY20Q2 = prettyNum(Impressions_FY20Q2, big.mark = ","),
          Impressions_FY20Q3 = prettyNum(Impressions_FY20Q3, big.mark = ","),
          Impressions_FY20Q4 = prettyNum(Impressions_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,
               FY19Q1 = Impressions_FY19Q1, 
               FY19Q2 = Impressions_FY19Q2, 
               FY19Q3 = Impressions_FY19Q3, 
               FY19Q4 = Impressions_FY19Q4, 
               FY20Q1 = Impressions_FY20Q1, 
               FY20Q2 = Impressions_FY20Q2, 
               FY20Q3 = Impressions_FY20Q3, 
               FY20Q4 = Impressions_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 7) %>%
  pack_rows("Text", 8, 8) %>%
  pack_rows("Video", 9,14) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Impressions" = 8))
```



### Click Through Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "GR") %>% 
        select(AdSets, CTR_FY19Q1:CTR_FY20Q4) %>% 
        mutate(
          CTR_FY19Q1 = paste0(round(CTR_FY19Q1*100,2), "%"),
          CTR_FY19Q2 = paste0(round(CTR_FY19Q2*100,2), "%"),
          CTR_FY19Q3 = paste0(round(CTR_FY19Q3*100,2), "%"),
          CTR_FY19Q4 = paste0(round(CTR_FY19Q4*100,2), "%"),
          CTR_FY20Q1 = paste0(round(CTR_FY20Q1*100,2), "%"),
          CTR_FY20Q2 = paste0(round(CTR_FY20Q2*100,2), "%"),
          CTR_FY20Q3 = paste0(round(CTR_FY20Q3*100,2), "%"),
          CTR_FY20Q4 = paste0(round(CTR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = CTR_FY19Q1, FY19Q2 = CTR_FY19Q2, FY19Q3 = CTR_FY19Q3, FY19Q4 = CTR_FY19Q4, FY20Q1 = CTR_FY20Q1, FY20Q2 = CTR_FY20Q2, FY20Q3 = CTR_FY20Q3, FY20Q4 = CTR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 7) %>%
  pack_rows("Text", 8, 8) %>%
  pack_rows("Video", 9,14) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Click Through Rate" = 8))
```

### Unique Pageviews

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "GR") %>% 
        select(AdSets, UPV_FY19Q1:UPV_FY20Q4) %>% 
        mutate(
          UPV_FY19Q1 = prettyNum(UPV_FY19Q1, big.mark = ","),
          UPV_FY19Q2 = prettyNum(UPV_FY19Q2, big.mark = ","),
          UPV_FY19Q3 = prettyNum(UPV_FY19Q3, big.mark = ","),
          UPV_FY19Q4 = prettyNum(UPV_FY19Q4, big.mark = ","),
          UPV_FY20Q1 = prettyNum(UPV_FY20Q1, big.mark = ","),
          UPV_FY20Q2 = prettyNum(UPV_FY20Q2, big.mark = ","),
          UPV_FY20Q3 = prettyNum(UPV_FY20Q3, big.mark = ","),
          UPV_FY20Q4 = prettyNum(UPV_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q1 = UPV_FY19Q1, FY19Q2 = UPV_FY19Q2, FY19Q3 = UPV_FY19Q3, FY19Q4 = UPV_FY19Q4, FY20Q1 = UPV_FY20Q1, FY20Q2 = UPV_FY20Q2, FY20Q3 = UPV_FY20Q3, FY20Q4 = UPV_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 7) %>%
  pack_rows("Text", 8, 8) %>%
  pack_rows("Video", 9,14) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Unique Pageviews" = 8))
```




### Bounce Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "GR") %>% 
        select(AdSets, BR_FY19Q1:BR_FY20Q4) %>% 
        mutate(
          BR_FY19Q1 = paste0(round(BR_FY19Q1*100,2), "%"),
          BR_FY19Q2 = paste0(round(BR_FY19Q2*100,2), "%"),
          BR_FY19Q3 = paste0(round(BR_FY19Q3*100,2), "%"),
          BR_FY19Q4 = paste0(round(BR_FY19Q4*100,2), "%"),
          BR_FY20Q1 = paste0(round(BR_FY20Q1*100,2), "%"),
          BR_FY20Q2 = paste0(round(BR_FY20Q2*100,2), "%"),
          BR_FY20Q3 = paste0(round(BR_FY20Q3*100,2), "%"),
          BR_FY20Q4 = paste0(round(BR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = BR_FY19Q1, FY19Q2 = BR_FY19Q2, FY19Q3 = BR_FY19Q3, FY19Q4 = BR_FY19Q4, FY20Q1 = BR_FY20Q1, FY20Q2 = BR_FY20Q2, FY20Q3 = BR_FY20Q3, FY20Q4 = BR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 7) %>%
  pack_rows("Text", 8, 8) %>%
  pack_rows("Video", 9,14) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Bounce Rate" = 8))
```

### Inquiries


```{r}
DCForms <- Forms %>% filter(str_detect(Initial.Referral.Source,"GR")) %>% 
  group_by(Created.Date) %>% 
  summarise(Inq = n()) %>% arrange(desc(Inq))


DCForms <- DCForms %>% 
  mutate(Date = as.Date(Created.Date, format = "%m/%d/%Y"),
         Quarter = ifelse(Date < "2018-10-01", "FY19 Q1", 
                          ifelse(Date >= "2018-10-01" & Date < "2018-12-31", "FY19 Q2", 
                                 ifelse(Date >= "2019-01-01" & Date < "2019-04-01", "FY19 Q3",
                                        ifelse(Date >= "2019-04-01" & Date < "2019-06-30", "FY19 Q4",
                                               ifelse(Date >= "2019-01-01" & Date < "2019-10-01", "FY20 Q1",
                                                      ifelse(Date >= "2019-10-01" & Date < "2019-12-31", "FY20 Q2",
                                                             ifelse(Date >= "2020-01-01" & Date < "2020-04-01", "FY20 Q3", "FY20 Q4")))))))) %>%  
        group_by(Quarter) %>% 
        summarise(Inquiries = sum(Inq)) %>% 
  spread(Quarter, Inquiries)
kable(DCForms %>% mutate(Program = "GR") %>% select(Program, everything())) %>% 
  kable_styling()
```

## Degree Completion Program {.tabset .tabset-pills}

### Impressions

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "DC") %>% 
        select(AdSets:Impressions_FY20Q4) %>% 
        mutate(
          Impressions_FY19Q1 = prettyNum(Impressions_FY19Q1, big.mark = ","),
          Impressions_FY19Q2 = prettyNum(Impressions_FY19Q2, big.mark = ","),
          Impressions_FY19Q3 = prettyNum(Impressions_FY19Q3, big.mark = ","),
          Impressions_FY19Q4 = prettyNum(Impressions_FY19Q4, big.mark = ","),
          Impressions_FY20Q1 = prettyNum(Impressions_FY20Q1, big.mark = ","),
          Impressions_FY20Q2 = prettyNum(Impressions_FY20Q2, big.mark = ","),
          Impressions_FY20Q3 = prettyNum(Impressions_FY20Q3, big.mark = ","),
          Impressions_FY20Q4 = prettyNum(Impressions_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,
               FY19Q1 = Impressions_FY19Q1, 
               FY19Q2 = Impressions_FY19Q2, 
               FY19Q3 = Impressions_FY19Q3, 
               FY19Q4 = Impressions_FY19Q4, 
               FY20Q1 = Impressions_FY20Q1, 
               FY20Q2 = Impressions_FY20Q2, 
               FY20Q3 = Impressions_FY20Q3, 
               FY20Q4 = Impressions_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 5) %>%
  pack_rows("Text", 6, 7) %>%
  pack_rows("Video", 8,9) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Impressions" = 8))
```



### Click Through Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "GR") %>% 
        select(AdSets, CTR_FY19Q1:CTR_FY20Q4) %>% 
        mutate(
          CTR_FY19Q1 = paste0(round(CTR_FY19Q1*100,2), "%"),
          CTR_FY19Q2 = paste0(round(CTR_FY19Q2*100,2), "%"),
          CTR_FY19Q3 = paste0(round(CTR_FY19Q3*100,2), "%"),
          CTR_FY19Q4 = paste0(round(CTR_FY19Q4*100,2), "%"),
          CTR_FY20Q1 = paste0(round(CTR_FY20Q1*100,2), "%"),
          CTR_FY20Q2 = paste0(round(CTR_FY20Q2*100,2), "%"),
          CTR_FY20Q3 = paste0(round(CTR_FY20Q3*100,2), "%"),
          CTR_FY20Q4 = paste0(round(CTR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = CTR_FY19Q1, FY19Q2 = CTR_FY19Q2, FY19Q3 = CTR_FY19Q3, FY19Q4 = CTR_FY19Q4, FY20Q1 = CTR_FY20Q1, FY20Q2 = CTR_FY20Q2, FY20Q3 = CTR_FY20Q3, FY20Q4 = CTR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 5) %>%
  pack_rows("Text", 6, 7) %>%
  pack_rows("Video", 8,9) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Click Through Rate" = 8))
```

### Unique Pageviews

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "GR") %>% 
        select(AdSets, UPV_FY19Q1:UPV_FY20Q4) %>% 
        mutate(
          UPV_FY19Q1 = prettyNum(UPV_FY19Q1, big.mark = ","),
          UPV_FY19Q2 = prettyNum(UPV_FY19Q2, big.mark = ","),
          UPV_FY19Q3 = prettyNum(UPV_FY19Q3, big.mark = ","),
          UPV_FY19Q4 = prettyNum(UPV_FY19Q4, big.mark = ","),
          UPV_FY20Q1 = prettyNum(UPV_FY20Q1, big.mark = ","),
          UPV_FY20Q2 = prettyNum(UPV_FY20Q2, big.mark = ","),
          UPV_FY20Q3 = prettyNum(UPV_FY20Q3, big.mark = ","),
          UPV_FY20Q4 = prettyNum(UPV_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q1 = UPV_FY19Q1, FY19Q2 = UPV_FY19Q2, FY19Q3 = UPV_FY19Q3, FY19Q4 = UPV_FY19Q4, FY20Q1 = UPV_FY20Q1, FY20Q2 = UPV_FY20Q2, FY20Q3 = UPV_FY20Q3, FY20Q4 = UPV_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 5) %>%
  pack_rows("Text", 6, 7) %>%
  pack_rows("Video", 8,9) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Unique Pageviews" = 8))
```




### Bounce Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "GR") %>% 
        select(AdSets, BR_FY19Q1:BR_FY20Q4) %>% 
        mutate(
          BR_FY19Q1 = paste0(round(BR_FY19Q1*100,2), "%"),
          BR_FY19Q2 = paste0(round(BR_FY19Q2*100,2), "%"),
          BR_FY19Q3 = paste0(round(BR_FY19Q3*100,2), "%"),
          BR_FY19Q4 = paste0(round(BR_FY19Q4*100,2), "%"),
          BR_FY20Q1 = paste0(round(BR_FY20Q1*100,2), "%"),
          BR_FY20Q2 = paste0(round(BR_FY20Q2*100,2), "%"),
          BR_FY20Q3 = paste0(round(BR_FY20Q3*100,2), "%"),
          BR_FY20Q4 = paste0(round(BR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = BR_FY19Q1, FY19Q2 = BR_FY19Q2, FY19Q3 = BR_FY19Q3, FY19Q4 = BR_FY19Q4, FY20Q1 = BR_FY20Q1, FY20Q2 = BR_FY20Q2, FY20Q3 = BR_FY20Q3, FY20Q4 = BR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Display", 1, 5) %>%
  pack_rows("Text", 6, 7) %>%
  pack_rows("Video", 8,9) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Bounce Rate" = 8))
```

### Inquiries


```{r}
DCForms <- Forms %>% filter(str_detect(Initial.Referral.Source,"DC")) %>% 
  group_by(Created.Date) %>% 
  summarise(Inq = n()) %>% arrange(desc(Inq))


DCForms <- DCForms %>% 
  mutate(Date = as.Date(Created.Date, format = "%m/%d/%Y"),
         Quarter = ifelse(Date < "2018-10-01", "FY19 Q1", 
                          ifelse(Date >= "2018-10-01" & Date < "2018-12-31", "FY19 Q2", 
                                 ifelse(Date >= "2019-01-01" & Date < "2019-04-01", "FY19 Q3",
                                        ifelse(Date >= "2019-04-01" & Date < "2019-06-30", "FY19 Q4",
                                               ifelse(Date >= "2019-01-01" & Date < "2019-10-01", "FY20 Q1",
                                                      ifelse(Date >= "2019-10-01" & Date < "2019-12-31", "FY20 Q2",
                                                             ifelse(Date >= "2020-01-01" & Date < "2020-04-01", "FY20 Q3", "FY20 Q4")))))))) %>%  
        group_by(Quarter) %>% 
        summarise(Inquiries = sum(Inq)) %>% 
  spread(Quarter, Inquiries)

kable(DCForms %>% mutate(Program = "DC") %>% select(Program, everything())) %>% 
  kable_styling()
```

## Out-of-State High School Students {.tabset .tabset-pills}

### Impressions

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TL") %>% 
        select(AdSets:Impressions_FY20Q4) %>% 
        mutate(
          Impressions_FY19Q1 = prettyNum(Impressions_FY19Q1, big.mark = ","),
          Impressions_FY19Q2 = prettyNum(Impressions_FY19Q2, big.mark = ","),
          Impressions_FY19Q3 = prettyNum(Impressions_FY19Q3, big.mark = ","),
          Impressions_FY19Q4 = prettyNum(Impressions_FY19Q4, big.mark = ","),
          Impressions_FY20Q1 = prettyNum(Impressions_FY20Q1, big.mark = ","),
          Impressions_FY20Q2 = prettyNum(Impressions_FY20Q2, big.mark = ","),
          Impressions_FY20Q3 = prettyNum(Impressions_FY20Q3, big.mark = ","),
          Impressions_FY20Q4 = prettyNum(Impressions_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q1 = Impressions_FY19Q1, FY19Q2 = Impressions_FY19Q2, FY19Q3 = Impressions_FY19Q3, FY19Q4 = Impressions_FY19Q4, FY20Q1 = Impressions_FY20Q1, FY20Q2 = Impressions_FY20Q2, FY20Q3 = Impressions_FY20Q3, FY20Q4 = Impressions_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video", 7,9) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Impressions" = 8))
```



### Click Through Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TL") %>% 
        select(AdSets, CTR_FY19Q1:CTR_FY20Q4) %>% 
        mutate(
          CTR_FY19Q1 = paste0(round(CTR_FY19Q1*100,2), "%"),
          CTR_FY19Q2 = paste0(round(CTR_FY19Q2*100,2), "%"),
          CTR_FY19Q3 = paste0(round(CTR_FY19Q3*100,2), "%"),
          CTR_FY19Q4 = paste0(round(CTR_FY19Q4*100,2), "%"),
          CTR_FY20Q1 = paste0(round(CTR_FY20Q1*100,2), "%"),
          CTR_FY20Q2 = paste0(round(CTR_FY20Q2*100,2), "%"),
          CTR_FY20Q3 = paste0(round(CTR_FY20Q3*100,2), "%"),
          CTR_FY20Q4 = paste0(round(CTR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = CTR_FY19Q1, FY19Q2 = CTR_FY19Q2, FY19Q3 = CTR_FY19Q3, FY19Q4 = CTR_FY19Q4, FY20Q1 = CTR_FY20Q1, FY20Q2 = CTR_FY20Q2, FY20Q3 = CTR_FY20Q3, FY20Q4 = CTR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video", 7,9) %>% 
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Click Through Rate" = 8))
```

### Unique Pageviews

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TL") %>% 
        select(AdSets, UPV_FY19Q1:UPV_FY20Q4) %>% 
        mutate(
          UPV_FY19Q1 = prettyNum(UPV_FY19Q1, big.mark = ","),
          UPV_FY19Q2 = prettyNum(UPV_FY19Q2, big.mark = ","),
          UPV_FY19Q3 = prettyNum(UPV_FY19Q3, big.mark = ","),
          UPV_FY19Q4 = prettyNum(UPV_FY19Q4, big.mark = ","),
          UPV_FY20Q1 = prettyNum(UPV_FY20Q1, big.mark = ","),
          UPV_FY20Q2 = prettyNum(UPV_FY20Q2, big.mark = ","),
          UPV_FY20Q3 = prettyNum(UPV_FY20Q3, big.mark = ","),
          UPV_FY20Q4 = prettyNum(UPV_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q1 = UPV_FY19Q1, FY19Q2 = UPV_FY19Q2, FY19Q3 = UPV_FY19Q3, FY19Q4 = UPV_FY19Q4, FY20Q1 = UPV_FY20Q1, FY20Q2 = UPV_FY20Q2, FY20Q3 = UPV_FY20Q3, FY20Q4 = UPV_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video", 7,9) %>%  
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Unique Page Views" = 8))
```




### Bounce Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "TL") %>% 
        select(AdSets, BR_FY19Q1:BR_FY20Q4) %>% 
        mutate(
          BR_FY19Q1 = paste0(round(BR_FY19Q1*100,2), "%"),
          BR_FY19Q2 = paste0(round(BR_FY19Q2*100,2), "%"),
          BR_FY19Q3 = paste0(round(BR_FY19Q3*100,2), "%"),
          BR_FY19Q4 = paste0(round(BR_FY19Q4*100,2), "%"),
          BR_FY20Q1 = paste0(round(BR_FY20Q1*100,2), "%"),
          BR_FY20Q2 = paste0(round(BR_FY20Q2*100,2), "%"),
          BR_FY20Q3 = paste0(round(BR_FY20Q3*100,2), "%"),
          BR_FY20Q4 = paste0(round(BR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets,FY19Q1 = BR_FY19Q1, FY19Q2 = BR_FY19Q2, FY19Q3 = BR_FY19Q3, FY19Q4 = BR_FY19Q4, FY20Q1 = BR_FY20Q1, FY20Q2 = BR_FY20Q2, FY20Q3 = BR_FY20Q3, FY20Q4 = BR_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video", 7,9) %>%  
  add_header_above(c(" " = 1, "FY19" = 4, "FY20" = 4)) %>% 
  add_header_above(c(" " = 1, "Bounce Rate" = 8))
```

```{r}
NewData1 <- read.csv("C:/Users/christine.iyer/Box/quarterly-ad-analytics-projects/ToursFlowchart - Copy.csv", header = T, stringsAsFactors = F)
```



```{r}
NewData2 <- NewData1 %>% 
  mutate(AdSets = str_sub(AdSet,6),BR = as.numeric(BR)) %>% 
  group_by(Quarter,AdSets ) %>% 
  summarise(Impressions = sum(Impressions), 
            CTR = mean(CTR), 
            UPV = sum(UPV), 
            BR = mean(BR)) %>% 
filter(Quarter != "") %>% select(AdSets, Quarter, everything())


spec_1 <- build_wider_spec(NewData2,
            names_from = Quarter, 
            values_from = c(Impressions:BR))

nD_3 <- NewData2 %>% pivot_wider_spec(spec_1, values_fill = 0)


nD4 <- nD_3 %>% 
  mutate(Campaign = ifelse(grepl("DC",AdSets),"DC",
                           ifelse(grepl("HS", AdSets), "HS", 
                                  ifelse(grepl("TR", AdSets), "TR", 
                                         ifelse(grepl("GR", AdSets), "GR", 
                                                ifelse(grepl("TL", AdSets), "TL", 
                                                       ifelse(grepl("CGCY", AdSets), "CGCY", 
                                                              ifelse(grepl("MPH|POL", AdSets), "MUS",
                                                                     ifelse(grepl("IN", AdSets),"IN",
                                                                                  ifelse(grepl("CLR",AdSets), "CLR", 
                                                                                               ifelse(grepl("ER|VT",AdSets) , "Tours", 
                                                                                                      ifelse(grepl("IC", AdSets), "SIC",  "Other"))))))))))), 
         Medium = ifelse(grepl("DISP", AdSets), "DISP", 
         ifelse(grepl("VID", AdSets), "VID", 
                ifelse(grepl("ST", AdSets), "ST",
                       ifelse(grepl("TEXT", AdSets), "TEXT",
                              ifelse(grepl("CAR", AdSets), "CAR", "AUD" )))))) %>% select(Medium,Campaign, everything()) %>% arrange(Medium)
```



## Tours:High School Students {.tabset .tabset-pills}

### Impressions

```{r}
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets:Impressions_FY19Q4,
               Impressions_FY20Q3:Impressions_FY20Q4, 
               # CTR_FY19Q3:CTR_FY19Q4,
               # CTR_FY20Q3:CTR_FY20Q4, UPV_FY19Q3:UPV_FY19Q4,
               # UPV_FY20Q3:UPV_FY20Q4,
               # UPV_FY19Q3:UPV_FY19Q4,
               # UPV_FY20Q3:UPV_FY20Q4,
               # BR_FY19Q3:BR_FY19Q4,
               # BR_FY20Q3:BR_FY20Q4 
               ) %>% 
        mutate(
          # Impressions_FY19Q1 = prettyNum(Impressions_FY19Q1, big.mark = ","),
          # Impressions_FY19Q2 = prettyNum(Impressions_FY19Q2, big.mark = ","),
          Impressions_FY19Q3 = prettyNum(Impressions_FY19Q3, big.mark = ","),
          Impressions_FY19Q4 = prettyNum(Impressions_FY19Q4, big.mark = ","),
          # Impressions_FY20Q1 = prettyNum(Impressions_FY20Q1, big.mark = ","),
          # Impressions_FY20Q2 = prettyNum(Impressions_FY20Q2, big.mark = ","),
          Impressions_FY20Q3 = prettyNum(Impressions_FY20Q3, big.mark = ","),
          Impressions_FY20Q4 = prettyNum(Impressions_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets, FY19Q3 = Impressions_FY19Q3, FY19Q4 = Impressions_FY19Q4,  FY20Q3 = Impressions_FY20Q3, FY20Q4 = Impressions_FY20Q4)) %>% 
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video",7, 9) %>% 
  add_header_above(c(" " = 1, "FY19" = 2, "FY20" = 2)) %>% 
  add_header_above(c(" " = 1, "Impressions" = 4))
```



### Click Through Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets, CTR_FY19Q3:CTR_FY19Q4, CTR_FY20Q3:CTR_FY20Q4) %>% 
        mutate(
          # CTR_FY19Q1 = paste0(round(CTR_FY19Q1*100,2), "%"),
          # CTR_FY19Q2 = paste0(round(CTR_FY19Q2*100,2), "%"),
          CTR_FY19Q3 = paste0(round(CTR_FY19Q3*100,2), "%"),
          CTR_FY19Q4 = paste0(round(CTR_FY19Q4*100,2), "%"),
          # CTR_FY20Q1 = paste0(round(CTR_FY20Q1*100,2), "%"),
          # CTR_FY20Q2 = paste0(round(CTR_FY20Q2*100,2), "%"),
          CTR_FY20Q3 = paste0(round(CTR_FY20Q3*100,2), "%"),
          CTR_FY20Q4 = paste0(round(CTR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets, FY19Q3 = CTR_FY19Q3, FY19Q4 = CTR_FY19Q4, FY20Q3 = CTR_FY20Q3, FY20Q4 = CTR_FY20Q4)) %>%
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video",7, 9) %>% 
  add_header_above(c(" " = 1, "FY19" = 2, "FY20" = 2)) %>% 
  add_header_above(c(" " = 1, "Click Through Rate" = 4))
```

### Unique Pageviews

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets, UPV_FY19Q3:UPV_FY19Q4,UPV_FY20Q3:UPV_FY20Q4) %>% 
        mutate(

          UPV_FY19Q3 = prettyNum(UPV_FY19Q3, big.mark = ","),
          UPV_FY19Q4 = prettyNum(UPV_FY19Q4, big.mark = ","),

          UPV_FY20Q3 = prettyNum(UPV_FY20Q3, big.mark = ","),
          UPV_FY20Q4 = prettyNum(UPV_FY20Q4, big.mark = ",")) %>% 
        rename(AdSet = AdSets,FY19Q3 = UPV_FY19Q3, FY19Q4 = UPV_FY19Q4,  FY20Q3 = UPV_FY20Q3, FY20Q4 = UPV_FY20Q4)) %>%
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video",7, 9) %>% 
  add_header_above(c(" " = 1, "FY19" = 2, "FY20" = 2)) %>% 
  add_header_above(c(" " = 1, "Unique Pageviews" = 4))
```




### Bounce Rate

```{r}

  
kable(nD4 %>% 
        filter(Campaign == "HS") %>% 
        select(AdSets, BR_FY19Q3:BR_FY19Q4, BR_FY20Q3:BR_FY20Q4) %>% 
        mutate(

          BR_FY19Q3 = paste0(round(BR_FY19Q3*100,2), "%"),
          BR_FY19Q4 = paste0(round(BR_FY19Q4*100,2), "%"),

          BR_FY20Q3 = paste0(round(BR_FY20Q3*100,2), "%"),
          BR_FY20Q4 = paste0(round(BR_FY20Q4*100,2), "%")) %>% 
        rename(AdSet = AdSets, 
               FY19Q3 = BR_FY19Q3, 
               FY19Q4 = BR_FY19Q4,  
               FY20Q3 = BR_FY20Q3, 
               FY20Q4 = BR_FY20Q4)) %>%
  kable_styling("striped")  %>%
  pack_rows("Carousel", 1,2) %>% 
  pack_rows("Display", 3, 6) %>%
  pack_rows("Video",7, 9) %>% 
  add_header_above(c(" " = 1, "FY19" = 2, "FY20" = 2)) %>% 
  add_header_above(c(" " = 1, "Bounce Rate" = 4))
```
